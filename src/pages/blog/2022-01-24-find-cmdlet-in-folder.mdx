---
templateKey: blog-post
title: How to find cmdlet in the entire folder
date: 2022-01-24T11:06:35.695Z
description: Learn how to find certain PowerShell cmdlets in all the scripts in the folder.
featuredpost: false
tags:
  - powershell
  - snippet
---
This blog post was inspired by the Microsoft Message Center announcement MC316139. It says about changes in the number assignment process via PowerShell.

The announcement points out three cmdlets to be fully retired. It also mentioned one cmdlet to be deprecated only for number assignment functionality.

## Issue

After we read the announcement, one question popped up. How to verify if the change affects our scripts? Let's try to go step by step and find a way.

## How to find where we use the cmdlets?

We'll follow a few steps:

* Define the list of cmdlets
* Get all `.ps1` files in the folder and its subfolders
* Search the files for *any* of the cmdlets

## Defining the list of cmdlets

We'll need an array of the string objects. Each element of the array will be a single cmdlet.

There are several ways to define such an array. We can do it in one line:

```powershell
$cmdletsToBeChecked = @("Set-CsUser", "Set-CsOnlineVoiceUser", "Set-CsOnlineApplicationInstance", "Set-CsOnlineVoiceApplicationInstance")
```

I prefer a way where I can easily paste the list. Each element comes to a separate line.

We can achieve this using [here-string](https://devblogs.microsoft.com/scripting/powertip-use-here-strings-with-powershell/).

Let's convert it to an array using [`-split` operator](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_split). Our delimiter will be a newline character.

```powershell
$cmdletsToBeChecked = @"
Set-CsUser
Set-CsOnlineVoiceUser
Set-CsOnlineApplicationInstance
Set-CsOnlineVoiceApplicationInstance
"@ -split "`n"

# A quick test to verify
$cmdletsToBeChecked[0]
# Should return
# Set-CsUser
```

<Tip>

  Depending on the OS, you might experience different splitting behavior.
  Check [this StackOverflow](https://stackoverflow.com/q/39252620) topic to find more options.

</Tip>

## Getting all script files

Now let's 

## Searching the files



## Full script

```powershell
$cmdletsToBeChecked = @"
Set-CsUser
Set-CsOnlineVoiceUser
Set-CsOnlineApplicationInstance
Set-CsOnlineVoiceApplicationInstance
"@ -split "`n"

Get-ChildItem . -File -Recurse -Filter "*.ps1" | Select-String -Pattern ($cmdletsToBeChecked -join "|")
```